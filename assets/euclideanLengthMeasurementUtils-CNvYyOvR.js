import{y7 as Ie,ys as Ve,yt as se,c9 as $t,dH as ht,yu as We,hE as Zt,R as ie,ae as ft,n as y,p as $,u as oe,S as Je,bZ as Be,yv as Ut,j_ as Ce,hm as jt,yw as Ge,dq as Ke,eL as Fe,yx as Ue,sP as Xe,gx as Ye,ns as Q,fo as F,fr as Qe,fp as ct,cq as h,gK as z,hl as T,i3 as L,cf as J,fs as K,h0 as pt,yy as qt,dJ as B,yz as tn,ft as mt,gE as Et,fu as dt,hB as xt,yA as Pt,yB as ae,gG as ue,yC as ce,mU as Y,w1 as lt,v0 as en,hz as S,l7 as le,f1 as nn,yD as rn,hI as w,lR as sn,xZ as on,cT as an,yE as un,pO as cn,yF as he,hA as fe,nm as pe,c$ as ln,yG as hn,lT as fn,mV as pn,yH as dn,yI as yn,yJ as gn,yK as $n,h1 as mn,sX as xn,yL as vn,yM as Xt,a$ as bn,b1 as de,mI as wn,mJ as Ln,d$ as _n,mB as Tn,yN as zn,mK as Mn,uP as V,dt as vt,yO as ye,go as Mt,yP as Nn}from"./index-Dg_V7Ho7.js";import{j as Rt,q as ge,b as $e,y as me}from"./geodesicUtils-BySj0T3d.js";import{g as Sn}from"./geometry2dUtils-BjT1yd1H.js";function xe(e,t,n){return M(e,t,n)}function M(e=0,t=0,n=0){return ht(e,t,n)}function Tr(e){return e}function zr(e){return e}function C(e,t,n){return ht(e,t,n)}function U(e){const[t,n,r]=e;return e.length>3?[t,n,r,e[3]]:[t,n,r]}function Mr(e){return e[3]=1|((e.length>3?e[3]:void 0)??0),e}function Nr(e){return!!(1&((e.length>3?e[3]:void 0)??0))}function Yt(e,t,{coordinateHelper:n,elevationInfo:r},s){return e?kn(n.vectorToDehydratedPoint(e,jn),t,r,s):null}function kn(e,t,n,r=M()){return r[0]=e.x,r[1]=e.y,r[2]=e.z??0,t==null||(t.type==="2d"?r[2]=0:r[2]=Ie(t,e,n,Zt)??0),r}function Sr(e,t,n){return n?(se(n,e[0],e[1],e[2],t),n):$t(e[0],e[1],e[2],t)}function kr(e,t,{z:n,m:r},s,i){const{spatialReference:o,elevationInfo:a}=s;let u;n==null&&r==null?u=void 0:t==null||t.type==="2d"?u=n??void 0:u=Ve(t,e,o,Zt,a)??0;const[c,l]=e;return i?se(i,c,l,u,o):i=$t(c,l,u,o),r!=null&&(i.m=r,i.hasM=!0),i}function jr(e,t,n,r,s=M()){const[i,o]=e;return s[0]=i,s[1]=o,e.length>3&&(s[3]=e[3]??0),n?.type!=="3d"?(s[2]=t.value,s):(s[2]=We(n,i,o,t.value,r,t.elevationInfo,Zt)??0,s)}const jn=$t(0,0,0,null);let q=class extends ie{constructor(){super(...arguments),this.enabled=!0}};y([$({type:Boolean})],q.prototype,"enabled",void 0),q=y([oe("esri.views.interactive.snapping.Settings.DefaultSnappingAlgorithm")],q);let d=class extends ie{constructor(t){super(t),this.lineSnapper=new q,this.parallelLineSnapper=new q,this.rightAngleSnapper=new q,this.rightAngleTriangleSnapper=new q,this.shortLineThreshold=15,this.distance=5,this.pointThreshold=1e-6,this.intersectionParallelLineThreshold=1e-6,this.parallelLineThreshold=1e-6,this.verticalLineThresholdMeters=.3,this.touchSensitivityMultiplier=1.5,this.pointOnLineThreshold=1e-6,this.orange=new ft([255,127,0]),this.orangeTransparent=new ft([255,127,0,.5]),this.lineHintWidthReference=3,this.lineHintWidthTarget=3,this.lineHintFadedExtensions=.3,this.parallelLineHintWidth=2,this.parallelLineHintLength=24,this.parallelLineHintOffset=1.5,this.rightAngleHintSize=24,this.rightAngleHintOutlineSize=1.5,this.satisfiesConstraintScreenThreshold=1}};y([$({type:q,constructOnly:!0,nonNullable:!0,json:{write:!0}})],d.prototype,"lineSnapper",void 0),y([$({type:q,constructOnly:!0,nonNullable:!0,json:{write:!0}})],d.prototype,"parallelLineSnapper",void 0),y([$({type:q,constructOnly:!0,nonNullable:!0,json:{write:!0}})],d.prototype,"rightAngleSnapper",void 0),y([$({type:q,constructOnly:!0,nonNullable:!0,json:{write:!0}})],d.prototype,"rightAngleTriangleSnapper",void 0),y([$({type:Number,nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],d.prototype,"shortLineThreshold",void 0),y([$({type:Number,nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],d.prototype,"distance",void 0),y([$({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],d.prototype,"pointThreshold",void 0),y([$({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],d.prototype,"intersectionParallelLineThreshold",void 0),y([$({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],d.prototype,"parallelLineThreshold",void 0),y([$({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],d.prototype,"verticalLineThresholdMeters",void 0),y([$({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],d.prototype,"touchSensitivityMultiplier",void 0),y([$({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],d.prototype,"pointOnLineThreshold",void 0),y([$({type:ft,nonNullable:!0})],d.prototype,"orange",void 0),y([$({type:ft,nonNullable:!0})],d.prototype,"orangeTransparent",void 0),y([$({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],d.prototype,"lineHintWidthReference",void 0),y([$({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],d.prototype,"lineHintWidthTarget",void 0),y([$({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],d.prototype,"lineHintFadedExtensions",void 0),y([$({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],d.prototype,"parallelLineHintWidth",void 0),y([$({type:Number,nonNullable:!0,range:{min:0,max:50},json:{write:!0}})],d.prototype,"parallelLineHintLength",void 0),y([$({type:Number,nonNullable:!0,range:{min:0,max:5},json:{write:!0}})],d.prototype,"parallelLineHintOffset",void 0),y([$({type:Number,nonNullable:!0,range:{min:0,max:46},json:{write:!0}})],d.prototype,"rightAngleHintSize",void 0),y([$({type:Number,nonNullable:!0,range:{min:0,max:6},json:{write:!0}})],d.prototype,"rightAngleHintOutlineSize",void 0),y([$({type:Number,nonNullable:!0,range:{min:0,max:5},json:{write:!0}})],d.prototype,"satisfiesConstraintScreenThreshold",void 0),d=y([oe("esri.views.interactive.snapping.Settings.Defaults")],d);const Pr=new d,Rr=Symbol("grid-placement-graphic");function qn(e,t){const n=e.x-t.x,r=e.y-t.y;return n*n+r*r}function Hr(e,t){return Math.sqrt(qn(e,t))}function Or(e,t){t.sort((n,r)=>jt(n.targetPoint,e)-jt(r.targetPoint,e))}function Zr({parameters:{point:e,distance:t,returnEdge:n,vertexMode:r,coordinateHelper:{spatialReference:s},filter:i},mode:o,returnZ:a,filter:u}){const c=u?.clone()??new Ke({where:"1=1"});return c.returnZ=a??o==="3d",i&&(c.geometry=i.geometry,c.distance=i.distance,c.spatialRelationship=i.spatialRelationship,c.where=Fe(c.where,i.where),c.timeExtent=Ue(c.timeExtent,i.timeExtent),c.objectIds=Pn(c.objectIds,i.objectIds)),{point:$t(e[0],e[1],e[2],s.toJSON()),mode:o,distance:t,returnEdge:n,vertexMode:r,query:c.toJSON()}}function Pn(e,t){return e||t?t?e?Array.from(Xe(new Set(e),new Set(t))):t:e:null}function Er(e,t,n){return{left:Yt(e.leftVertex.pos,t,n),right:Yt(e.rightVertex.pos,t,n)}}const Qt=Symbol("snapping-toggle");function Ar(e,t=()=>{}){const n=Je(()=>({view:e.view,snappingOptions:e.snappingOptions}),({view:r,snappingOptions:s})=>{if(e.removeHandles(Qt),!r||!s)return;const i=Ce.TOOL,o=[r.on("key-down",a=>{a.key!==Ut.toggle||a.repeat||(s.enabledToggled=!0,t())},i),r.on("key-up",a=>{a.key===Ut.toggle&&(s.enabledToggled=!1,t())},i),r.on("pointer-move",a=>{const u=a.native.ctrlKey;s.enabledToggled!==u&&(s.enabledToggled=u,t())},i)];e.addHandles(o,Qt)},Be);e.addHandles(n)}function Dr(e){return Ge(e)&&"utilityNetworks"in e&&!!e.utilityNetworks?.length}function Ir(e){return e?.type==="line"}function At({start:e,end:t,type:n},r,s){const i=[],o=F(tt,t,e),a=F(bt,e,r),u=dt(o),c=2*mt(o,a),l=c*c-4*u*(dt(a)-s*s);if(l===0){const f=-c/(2*u);(n===0||f>=0)&&i.push(ct(K(),e,o,f))}else if(l>0){const f=Math.sqrt(l),m=(-c+f)/(2*u);(n===0||m>=0)&&i.push(ct(K(),e,o,m));const g=(-c-f)/(2*u);(n===0||g>=0)&&i.push(ct(K(),e,o,g))}return i}function ve(e,t){const n=e.start,r=e.end,s=F(tt,r,n),i=J(Lt,-s[1],s[0],0),o=t.start,a=t.end,u=z(It,a,o),c=T(u,i),l=J(Ne,n[0],n[1],0),f=z(Se,l,o),m=T(f,i),g=Q();if(Math.abs(c)<g)return[];const b=L(ke,o,u,m/c);if(t.type===0){const _=z(Ht,b,o);if(T(_,u)<-g)return[]}if(e.type===1){const _=tn(bt,b,n);if(mt(_,s)<-g)return[]}return[B(b)]}function Rn(e,t){return On(yt(Vt,t[2],e),t)}function be(e,t){return ze(yt(Vt,0,e),yt(Dn,0,t)).map(([r,s])=>lt(r,s))}function we(e,t,n){return _e(e,yt(Vt,e[2],t),n)}function Le(e,t,n,r=h()){const s=F(tt,e,t),i=Qe(s);return ct(r,t,s,i===0?1:n/i),r[2]=e[2],r}function _e(e,{start:t,end:n,type:r},s=h()){const i=z(wt,e,t),o=z(Lt,n,t),a=T(i,o)/T(o,o);return L(s,t,o,r===0?Math.max(a,0):a)}const Hn=(()=>{const e=h(),t=h(),n=h();return({start:r,end:s},{center:i,radius:o,normal:a,slicePlane:u})=>{const c=xt(i,a,An);if(p(Pt(c,r),0)&&p(Pt(c,s),0)){ae(a,e,t);const f=(b,_)=>(Et(n,_,i),le(b,T(n,e),T(n,t)),b),m=Sn({start:f(tt,r),end:f(bt,s)},nn,o),g=[];for(const[b,_]of m){const N=ue(h(),i);L(N,N,e,b),L(N,N,t,_),u&&!W(u,N)||g.push(N)}return g}const l=h();return ce(c,r,s,l)?!p(Y(l,i),o)||u&&!W(u,l)?[]:[l]:[]}})();function Te({start:e,end:t,type:n},r,s){const i=[],o=Et(wt,t,e),a=F(bt,e,r),u=dt(o),c=2*mt(o,a),l=c*c-4*u*(dt(a)-s*s);if(l===0){const f=-c/(2*u);(n===1||f>=0)&&i.push(L(h(),e,o,f))}else if(l>0){const f=Math.sqrt(l),m=(-c+f)/(2*u);(n===1||m>=0)&&i.push(L(h(),e,o,m));const g=(-c-f)/(2*u);(n===1||g>=0)&&i.push(L(h(),e,o,g))}return i}function ze(e,t){const n=e.start,r=e.end,s=t.start,i=t.end,o=z(wt,r,n),a=z(Lt,i,s),u=z(It,s,n),c=pt(Ne,o,a);if(!p(T(u,c),0))return[];const l=qt(c);if(p(l,0))return[];const f=pt(Se,u,a),m=T(f,c)/l,g=L(ke,n,o,m);if(e.type===0){const b=z(Ht,g,n);if(T(o,b)<-Q())return[]}if(t.type===0){const b=z(Ht,g,s);if(T(a,b)<-Q())return[]}return[B(g)]}function On({start:e,end:t,type:n},r){const s=z(wt,r,e),i=z(Lt,t,e),o=pt(It,i,s),a=qt(o)/qt(i),u=Q();if(a<u)switch(n){case 1:return[B(r)];case 0:return T(i,s)<-u?[]:[B(r)]}return[]}function Dt(e,t,n,r){const[s,i]=e,[o,a]=n,u=o-s,c=a-i,l=u*u+c*c,f=Math.sqrt(l);if(f>t+r)return[];if(f<Math.abs(t-r))return[];if(p(f,0)&&p(t,r))return[];const m=(t*t-r*r+l)/(2*f),g=Math.sqrt(t*t-m*m),b=g*c/f,_=g*u/f,[N,G]=en(tt,e,n,m/f);return p(b,_)?[lt(N,G)]:[lt(N+b,G-_),lt(N-b,G+_)]}function yt(e,t,{start:n,end:r,type:s}){return J(e.start,n[0],n[1],t),J(e.end,r[0],r[1],t),e.type=En[s],e}function Me(e,t){return p(e[2],t[2])}function p(e,t){return Ye(Math.abs(e-t),0,Q())}function Zn(e,t){return t.filter(n=>W(e,n))}function W(e,t){return rn(e,t)}const En={0:1,1:0},tt=K(),bt=K(),wt=h(),Lt=h(),It=h(),Ne=h(),Se=h(),ke=h(),Ht=h(),An=S(),Vt={start:h(),end:h(),type:1},Dn={start:h(),end:h(),type:1};class k{intersect(t){return Z(this,t)}closestPoints(t){return[this.closestTo(t)]}}class et extends k{constructor(t){super(),this.point=t}equals(t){return this===t||j(t)&&w(this.point,t.point)}closestTo(){return U(this.point)}}class Wt extends k{constructor(t,n,r){super(),this.start=t,this.end=n,this.lineLike={start:t,end:n,type:r}}equals(t){return this===t||R(t)&&this.lineLike.type===t.lineLike.type&&w(this.start,t.start)&&w(this.end,t.end)}closestTo(t){const n=M();return _e(t,this.lineLike,n),n}}class je extends Wt{constructor(t,n){super(t,n,1)}}class In extends Wt{constructor(t,n){super(t,n,0)}}class qe extends k{constructor(t){super(),this.constraints=t}equals(t){return this===t||Ot(t)&&ln(this.constraints,t.constraints,(n,r)=>n.equals(r))}closestTo(t){let n,r=1/0;for(const s of this.constraints){const i=s.closestTo(t),o=jt(t,i);o<r&&(r=o,n=i)}return U(n??t)}closestPoints(t){return this.constraints.flatMap(n=>n===this?[]:n.closestPoints(t))}}class Vn extends k{constructor(t,n){super(),this.center=t,this.radius=n}equals(t){return this===t||O(t)&&this.center[0]===t.center[0]&&this.center[1]===t.center[1]&&this.radius===t.radius}closestTo(t){const n=M();return Le(t,this.center,this.radius,n),n}}class Jt extends k{constructor(t,n){super(),this.center=t,this.radius=n}equals(t){return this===t||A(t)&&w(this.center,t.center)&&this.radius===t.radius}closestTo(t){const n=M();return Le(t,this.center,this.radius,n),n[2]=this.center[2],n}asCircle(){return new Bt(U(this.center),this.radius,C(0,0,1))}}class Bt extends k{constructor(t,n,r,s=void 0){super(),this.center=t,this.radius=n,this.normal=r,this.slicePlane=s}equals(t){return this===t||I(t)&&w(this.center,t.center)&&w(this.normal,t.normal)&&this.radius===t.radius}closestTo(t){const{center:n,radius:r}=this;he(this.getPlane(Wn),t,Nt);const s=z(Nt,Nt,n),i=fn(s);if(p(i,0))return U(t);const o=r/Math.sqrt(i),a=M();L(a,n,s,o);const{slicePlane:u}=this;return u&&!W(u,a)?Gt(u,this)?.closestTo(t)??U(t):a}getPlane(t=S()){return xt(this.center,this.normal,t)}}const Nt=h(),Wn=S();class Jn extends k{constructor(t){super(),this.z=t}equals(t){return this===t||E(t)&&this.z===t.z}closestTo(t){return C(t[0],t[1],this.z)}getPlane(t=S()){return J(te,0,0,this.z),xt(te,hn,t)}}const te=h();class Ct extends k{constructor(t,n,r){super(),this.start=t,this.end=n,this.planeLike={start:t,end:n,type:r}}equals(t){return this===t||H(t)&&this.planeLike.type===t.planeLike.type&&w(this.start,t.start)&&w(this.end,t.end)}closestTo(t){const n=M();return we(t,this.planeLike,n),n}closestEndTo(t){const{start:n,end:r}=this.planeLike;return Math.sign(mt(F(Bn,r,n),F(Cn,t,n)))>0?this.end:this.start}getPlane(t=S()){const n=ue(ee,this.end);return n[2]+=1,sn(this.start,this.end,n,t)}getSlicePlane(t=S()){const{start:n,end:r,type:s}=this.planeLike;if(s===0)return;const i=J(ee,n[0],n[1],0),o=J(ne,r[0],r[1],0),a=Et(ne,o,i);return xt(i,a,t),t}}const Bn=K(),Cn=K(),ee=h(),ne=h();class Vr extends Ct{constructor(t,n){super(t,n,1)}}class Wr extends Ct{constructor(t,n){super(t,n,0)}}class Gn extends k{constructor(t,n){super(),this.sphere=pn(t,n),this._center=B(t)}equals(t){return this===t||D(t)&&dn(this.sphere,t.sphere)}closestTo(t){const n=M();return yn(this.sphere,t,n),n}get center(){return this._center}get radius(){return this.sphere[3]}}class Kn extends k{constructor(t,n,r){super(),this.start=t,this.end=n,this.getZ=r,this.planeLike={start:t,end:n,type:0}}equals(t){return this===t||gt(t)&&w(this.start,t.start)&&w(this.end,t.end)&&this.getZ===t.getZ}closestTo(t){return tr(this,t)}addIfOnTheGround(t,n){for(const r of n){const s=this.getZ(r[0],r[1])??0;p(r[2],s)&&(r[2]=s,t.push(r))}}}class Fn extends k{constructor(t,n,r){super(),this._x=t,this._y=n,this._z=r}equals(t){return this===t||gr(t)&&this._x===t._x&&this._y===t._y&&this._z===t._z}closestTo([t,n,r]){return xe(this._x??t,this._y??n,this._z??r)}}class Un extends k{constructor(t,n,r,s,i){super(),this._origin=t,this._spatialReference=n,this._distanceMeters=r,this._z=s,this._directionDegrees=i}equals(t){return this===t||yr(t)&&Xt(this._origin,t._origin)&&this._spatialReference===t._spatialReference&&this._distanceMeters===t._distanceMeters&&this._z===t._z&&this._directionDegrees===t._directionDegrees}closestTo([t,n,r]){return le(X,t,n),Xt(X,this._origin)||this._applyDirectionAndDistance(X),xe(X[0],X[1],this._z??r)}_applyDirectionAndDistance(t){if(this._directionDegrees!=null&&this._distanceMeters!=null)Rt(t,this._origin,this._directionDegrees,this._distanceMeters,this._spatialReference);else if(this._directionDegrees!=null)Yn(t,this._origin,this._directionDegrees,t,this._spatialReference);else if(this._distanceMeters!=null){const{azimuth:n}=ge(Xn,this._origin,t,this._spatialReference);Rt(t,this._origin,n??0,this._distanceMeters,this._spatialReference)}}}const X=[0,0],Xn=new $e;function Yn(e,t,n,r,s){let{azimuth:i,distance:o}=ge(Qn,t,r,s);i??=0;let a=o*Math.cos((i-n)*bn);a=Math.max(0,a),Rt(e,t,n,a,s)}const Qn=new $e;function tr(e,t){const n=M();return we(t,e.planeLike,n),n[2]=e.getZ(n[0],n[1])??Re,n}function Z(e,t){if(Ot(e)){const n=[];for(const r of e.constraints){const s=r.intersect(t);s&&n.push(s)}return Kt(n)}if(Ot(t))return Z(t,e);if(gt(e))return re(e,t);if(gt(t))return re(t,e);if(j(e)){const{point:n}=e;if(j(t))return w(n,t.point)?e:void 0;const r=t.closestTo(n);return on(r,n)?e:void 0}if(R(e)){if(j(t))return Z(t,e);if(R(t))return P(ze(e.lineLike,t.lineLike));if(E(t))return er(e,t);if(H(t))return P(ve(t.planeLike,e.lineLike));if(O(t))return P(Te(e.lineLike,t.center,t.radius));if(I(t))return P(Hn(e.lineLike,t));if(A(t))return nr(e,t);if(D(t))return rr(e,t)}else if(E(e)){if(j(t)||R(t))return Z(t,e);if(E(t))return sr(e,t);if(H(t))return ir(e,t);if(O(t))return or(e,t);if(I(t))return ur(e,t);if(A(t))return ar(e,t);if(D(t))return cr(e,t)}else if(H(e)){if(j(t)||R(t)||E(t))return Z(t,e);if(H(t))return St(be(e.planeLike,t.planeLike));if(O(t))return St(At(e.planeLike,t.center,t.radius));if(I(t))return hr(e,t);if(A(t))return lr(e,t);if(D(t))return fr(e,t)}else if(O(e)){if(j(t)||R(t)||E(t)||H(t))return Z(t,e);if(O(t))return St(Dt(e.center,e.radius,t.center,t.radius));if(I(t))return void 0;if(A(t))return pr(e,t);if(D(t))return void 0}else if(I(e)){if(j(t)||R(t)||E(t)||H(t)||O(t))return Z(t,e);if(I(t))return void 0;if(A(t))return t.asCircle(),void 0;if(D(t))return void 0}else if(A(e)){if(j(t)||R(t)||E(t)||H(t)||O(t)||I(t))return Z(t,e);if(A(t))return dr(t,e);if(D(t))return void 0}else if(D(e)){if(j(t)||R(t)||E(t)||H(t)||O(t)||A(t))return Z(t,e);if(D(t))return void 0}}const er=(()=>{const e=S();return(t,n)=>{const{start:r,end:s}=t;if(Me(r,s)&&p(r[2],n.z))return t;const i=M();return ce(n.getPlane(e),r,s,i)?new et(i):void 0}})();function nr({lineLike:e},{center:t,radius:n}){const r=t[2];return P(Te(e,t,n).filter(s=>p(s[2],r)))}function rr({lineLike:e},{sphere:t}){return P(un(t,e.start,e.end))}const Gt=(()=>{const e=xn(),t=h(),n=h();return(r,s,i)=>{const{normal:o,center:a,radius:u}=s;ae(o,t,n);const c=fe(r),l=u*T(c,t),f=u*T(c,n);gn(e,a[0],a[1],a[2],1);const m=$n(r,e),g=Math.hypot(l,f),b=p(g,0);if(p(Pt(r,a),0)){if(b)return s;if(p(u,0))return!i||W(i,a)?new et(U(a)):void 0;pt(t,c,o),mn(t,t);const zt=new Array,it=B(a);L(it,it,t,u),i&&!W(i,it)||zt.push(it);const ot=B(a);return L(ot,ot,t,-u),i&&!W(i,ot)||zt.push(ot),P(zt)}if(b)return;const _=-m/g;if(Math.abs(_)>1||p(_,1))return;const N=Math.atan(l/f),G=vn(_)-N,Ft=Math.PI-G,nt=new Array,rt=h();L(rt,a,t,u*Math.cos(G)),L(rt,rt,n,u*Math.sin(G)),nt.push(rt);const st=h();return L(st,a,t,u*Math.cos(Ft)),L(st,st,n,u*Math.sin(Ft)),nt.push(st),P(i?Zn(i,nt):nt)}})();function sr(e,t){return p(e.z,t.z)?e:void 0}function ir({z:e},{planeLike:t}){const[n,r]=t.start,[s,i]=t.end,o=C(n,r,e),a=C(s,i,e);return t.type===0?new je(o,a):new In(o,a)}function or(e,t){const[n,r]=t.center;return new Jt(C(n,r,e.z),t.radius)}function ar(e,t){return p(t.center[2],e.z)?t:void 0}const ur=(()=>{const e=S();return(t,n)=>Gt(t.getPlane(e),n,n.slicePlane)})();function cr(e,{center:t,radius:n}){const r=Math.abs(t[2]-e.z);if(r>n&&!p(r,n))return;const s=C(t[0],t[1],e.z),i=Math.sqrt(n**2-r**2);return p(i,0)?void 0:new Jt(s,i)}const lr=(()=>{const e=S();return(t,{center:n,radius:r})=>{const s=At(t.planeLike,n,r),i=n[2];t.getSlicePlane(e);const o=new Array;for(const[a,u]of s){const c=[a,u,i];W(e,c)&&o.push(c)}return P(o)}})(),hr=(()=>{const e=S(),t=S();return(n,r)=>Gt(n.getPlane(e),r,n.getSlicePlane(t))})(),fr=(()=>{const e=S();return(t,{center:n,radius:r})=>{const s=t.getPlane(e),i=cn(s,n),o=Math.abs(i);if(o>r&&!p(o,r))return;const a=Math.sqrt(r**2-i**2);if(p(a,0)){const l=M();return he(s,n,l),new et(l)}const u=M(),c=B(fe(s));return L(u,n,c,i),new Bt(u,a,c,t.getSlicePlane())}})();function pr(e,t){const n=pe(e.center,t.center);return p(n,0)&&p(e.radius,t.radius)?t:Pe(Dt(e.center,e.radius,t.center,t.radius),t.center[2])}function dr(e,t){if(!Me(e.center,t.center))return;const n=pe(e.center,t.center);return p(n,0)&&p(e.radius,t.radius)?e:Pe(Dt(e.center,e.radius,t.center,t.radius),e.center[2])}function re(e,t){const{planeLike:n,getZ:r}=e,s=new Array;if(j(t))e.addIfOnTheGround(s,Rn(n,t.point));else if(R(t))e.addIfOnTheGround(s,ve(n,t.lineLike));else if(O(t))for(const[i,o]of At(n,t.center,t.radius)){const a=r(i,o);a!=null&&s.push(ht(i,o,a))}else if(H(t)||gt(t))for(const[i,o]of be(n,t.planeLike)){const a=r(i,o)??Re;s.push(ht(i,o,a))}return P(s)}function St(e){return Kt(e.map(([t,n])=>{const r=C(t,n,0),s=C(t,n,1);return new je(r,s)}))}function P(e){return Kt(e.map(t=>t?new et(t):void 0))}function Pe(e,t){return P(e.map(([n,r])=>[n,r,t]))}function Kt(e){if(e.length!==0)return e.length===1?e[0]??void 0:new qe(e.filter(an))}function Ot(e){return e instanceof qe}function j(e){return e instanceof et}function R(e){return e instanceof Wt}function E(e){return e instanceof Jn}function H(e){return e instanceof Ct}function O(e){return e instanceof Vn}function A(e){return e instanceof Jt}function I(e){return e instanceof Bt}function D(e){return e instanceof Gn}function gt(e){return e instanceof Kn}function yr(e){return e instanceof Un}function gr(e){return e instanceof Fn}const Re=0;let _t=class{constructor(t,n){this.isDraped=t,this.domain=n}};class He extends _t{constructor(t,n,r,s,i=3,o=!0,a=!0){super(s,i),this.type=t,this.lineStart=n,this.lineEnd=r,this.fadeLeft=o,this.fadeRight=a}equals(t){return t instanceof He&&this.type===t.type&&w(this.lineStart,t.lineStart)&&w(this.lineEnd,t.lineEnd)&&this.fadeLeft===t.fadeLeft&&this.fadeRight===t.fadeRight}get length(){return Y(this.lineStart,this.lineEnd)}}class Oe extends _t{constructor(t,n,r=3){super(n,r),this.intersectionPoint=t}equals(t){return t instanceof Oe&&w(this.intersectionPoint,t.intersectionPoint)}}let Br=class Ze extends _t{constructor(t,n,r,s=3){super(r,s),this.lineStart=t,this.lineEnd=n}equals(t){return t instanceof Ze&&w(this.lineStart,t.lineStart)&&w(this.lineEnd,t.lineEnd)}},Cr=class Ee extends _t{constructor(t,n,r,s,i=3){super(s,i),this.previousVertex=t,this.centerVertex=n,this.nextVertex=r}equals(t){return t instanceof Ee&&w(this.previousVertex,t.previousVertex)&&w(this.centerVertex,t.centerVertex)&&w(this.nextVertex,t.nextVertex)}};function Gr(e){return me(e)||de(e)}function Kr(e,t,n,...r){return me(e)?t.apply(void 0,r):e.isWebMercator?n.apply(void 0,r):null}const Fr=1e5;function Ae(e){return Ln(e)?_n(e)||de(e)||Tn(e)||zn(e)?wn:e:Mn(e)}function Ur(e){return $r(e)}function $r(e,t){const{hasZ:n,spatialReference:r}=e,s=Ae(r);let i=0;const o=ye(s);if(o==null)return null;const a=De;for(const u of e.paths){if(u.length<2)continue;const c=u.length-1;for(let l=0;l<c;++l){const f=u[l];x[0]=f[0],x[1]=f[1],x[2]=n?f[2]:0;const m=u[l+1];v[0]=m[0],v[1]=m[1],v[2]=n?m[2]:0;const g=a(x,v,r);if(g==null)return null;i+=g.value}}return V(i,o)}function Xr(e,t){const{spatialReference:n}=e;return vt(n,t.spatialReference)?(x[0]=e.x,x[1]=e.y,x[2]=e.hasZ?e.z:0,v[0]=t.x,v[1]=t.y,v[2]=t.hasZ?t.z:0,xr(x,v,n)):null}function Yr(e,t){const{spatialReference:n}=e;return vt(n,t.spatialReference)?(x[0]=e.x,x[1]=e.y,x[2]=e.hasZ?e.z:0,v[0]=t.x,v[1]=t.y,v[2]=t.hasZ?t.z:0,vr(x,v,n)):null}function Qr(e,t){const{spatialReference:n}=e;return vt(n,t.spatialReference)?(x[0]=e.x,x[1]=e.y,x[2]=e.hasZ?e.z:0,v[0]=t.x,v[1]=t.y,v[2]=t.hasZ?t.z:0,De(x,v,n)):null}function ts(e,t){const{spatialReference:n}=e;return vt(n,t.spatialReference)?(x[0]=e.x,x[1]=e.y,x[2]=e.hasZ?e.z:0,v[0]=t.x,v[1]=t.y,v[2]=t.hasZ?t.z:0,br(x,v,n)):null}function es(e){return e!=null?mr(e.hasZ?e.z:0,e.spatialReference):null}function mr(e,t){const n=Nn(t);return n!=null?V(e??0,n):null}function xr(e,t,n){const r=Tt(e,t,n);return r!=null?{direct:V(r.direct,r.unit),horizontal:V(r.horizontal,r.unit),vertical:V(r.vertical,r.unit)}:null}function vr(e,t,n){const r=Tt(e,t,n,0);return r!=null?V(r.direct,r.unit):null}function De(e,t,n){const r=Tt(e,t,n,1);return r!=null?V(r.horizontal,r.unit):null}function br(e,t,n){const r=Tt(e,t,n,2);return r!=null?V(r.verticalSigned,r.unit):null}function Tt(e,t,n,r){const s=Ae(n),i=ye(s);if(i==null)return null;const o=t[2]-e[2];if(r===2)return{verticalSigned:o,unit:i};if(!Mt(e,n,kt,s)||!Mt(t,n,at,s))return null;if(r===0)return{direct:Y(at,kt),unit:i};if(J(ut,e[0],e[1],t[2]),!Mt(ut,n,ut,s))return null;const a=Y(ut,at);return r===1?{horizontal:a,unit:i}:{direct:Y(at,kt),horizontal:a,vertical:Math.abs(o),unit:i}}const x=h(),v=h(),kt=h(),at=h(),ut=h();export{Gr as A,qn as B,Ir as C,Vr as D,Er as E,Ar as F,Yr as G,Fr as H,jr as I,vr as J,Kn as K,je as L,Wr as M,Vn as N,_e as O,kn as P,kr as Q,Fn as R,Kt as S,Jn as T,Un as U,mr as V,j as W,ts as X,br as Y,De as Z,Xr as _,Ur as a,zr as b,Mr as c,Rr as d,C as e,M as f,et as g,Zr as h,Ae as i,Oe as j,He as k,xe as l,Qr as m,Cr as n,Yt as o,Pr as p,Hr as q,Br as r,_t as s,Kr as t,Sr as u,Nr as v,Tr as w,Dr as x,Or as y,es as z};
